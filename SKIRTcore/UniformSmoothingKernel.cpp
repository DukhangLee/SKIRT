/*//////////////////////////////////////////////////////////////////
////       SKIRT -- an advanced radiative transfer code         ////
////       Â© Astronomical Observatory, Ghent University         ////
///////////////////////////////////////////////////////////////// */

#include <cmath>
#include "UniformSmoothingKernel.hpp"
#include "Random.hpp"

using namespace std;

//////////////////////////////////////////////////////////////////////

UniformSmoothingKernel::UniformSmoothingKernel()
{
}

//////////////////////////////////////////////////////////////////////

void UniformSmoothingKernel::setupSelfBefore()
{
    SmoothingKernel::setupSelfBefore();
}

//////////////////////////////////////////////////////////////////////

double
UniformSmoothingKernel::density(double u)
const
{
    if (u<0.0 || u>1.0) return 0.0;
    return 0.75/M_PI;
}

//////////////////////////////////////////////////////////////////////

double
UniformSmoothingKernel::generateRadius()
const
{
    double X = find<Random>()->uniform();
    return pow(X,1.0/3.0);
}

//////////////////////////////////////////////////////////////////////
