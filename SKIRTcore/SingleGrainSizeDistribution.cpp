/*//////////////////////////////////////////////////////////////////
////       SKIRT -- an advanced radiative transfer code         ////
////       Â© Astronomical Observatory, Ghent University         ////
//////////////////////////////////////////////////////////////////*/

#include "FatalError.hpp"
#include "SingleGrainSizeDistribution.hpp"

////////////////////////////////////////////////////////////////////

SingleGrainSizeDistribution::SingleGrainSizeDistribution()
    : _as(0)
{
}

////////////////////////////////////////////////////////////////////

void SingleGrainSizeDistribution::setupSelfBefore()
{
    GrainSizeDistribution::setupSelfBefore();

    // verify the grain size
    if (_as <= 0) throw FATALERROR("Single grain size must be positive");
}

////////////////////////////////////////////////////////////////////

void SingleGrainSizeDistribution::setSize(double value)
{
    _as = value;
}

////////////////////////////////////////////////////////////////////

double SingleGrainSizeDistribution::size() const
{
    return _as;
}

////////////////////////////////////////////////////////////////////

double SingleGrainSizeDistribution::amin() const
{
    return _as-_as/2000.;
}

////////////////////////////////////////////////////////////////////

double SingleGrainSizeDistribution::amax() const
{
    return _as+_as/2000.;
}

////////////////////////////////////////////////////////////////////

double SingleGrainSizeDistribution::dnda(double /*a*/) const
{
    return _C * 1000./_as;
}

////////////////////////////////////////////////////////////////////
